(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{"tm+F":function(e,n,a){"use strict";a.r(n);var t=a("q1tI"),l=a.n(t),o=(a("B2uJ"),a("+su7"),a("qOys")),s=a.n(o);a("5Yjd");n["default"]=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"\u63d2\u4ef6-plugins"},l.a.createElement("a",{"aria-hidden":"true",href:"#\u63d2\u4ef6-plugins"},l.a.createElement("span",{className:"icon icon-link"})),"\u63d2\u4ef6 Plugins"),l.a.createElement("p",null,"Schema \u662f\u53ef\u62d3\u5c55\u7684\uff0c\u4f60\u53ef\u4ee5\u7528\u6253\u5305\u597d\u7684\u529f\u80fd\u62d3\u5c55\u4f60\u7684 Schema\u3002"),l.a.createElement("p",null,"\u8bd5\u60f3\u6570\u636e\u5e93\u4e2d\u6709\u5f88\u591a\u4e2a collection\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u5b83\u4eec\u90fd\u6dfb\u52a0\u8bb0\u5f55\u300c\u6700\u540e\u4fee\u6539\u300d\u7684\u529f\u80fd\u3002\u521b\u5efa\u4e00\u6b21\u63d2\u4ef6\uff0c\u7136\u540e\u5e94\u7528\u5230\u6bcf\u4e2a Schema \u5c31\u597d\u4e86\u3002"),l.a.createElement(s.a,{code:"// lastMode.js\nmodule.exports = exports = function lastModifiedPlugin(schema, options){\n    schema.add({ lastMode: Date })\n\n    schema.pre('save', function(next){\n        this.lastMod = new Date();\n        next();\n    });\n\n    if (options && options.index){\n        schema.path('lastMod').index(options.index);\n    }\n}\n\n// game-schema.js\nconst lastMod = require('./lastMod');\nconst Game = new Schema({ ... });\nGame.plugin(lastMod, { index: true });\n\n// player-schema.js\nconst lastMod = require('./lastMod');\nconst Player = new Schema({ ... });\nPlayer.plugin(lastMod);\n",lang:"js"}),l.a.createElement("p",null,"\u8fd9\u6837\u5c31\u5df2\u7ecf\u5728 ",l.a.createElement("code",null,"Game")," \u548c ",l.a.createElement("code",null,"Player")," \u6dfb\u52a0\u4e86\u8bb0\u5f55\u6700\u540e\u4fee\u6539\u529f\u80fd\uff0c \u540c\u65f6\u5bf9 ",l.a.createElement("code",null,"game")," \u7684 ",l.a.createElement("code",null,"lastMod")," \u6dfb\u52a0\u7d22\u5f15\u3002\u8fd9\u5be5\u5be5\u51e0\u884c\u4ee3\u7801\uff0c\u770b\u8d77\u6765\u4e0d\u9519\u3002"),l.a.createElement("h2",{id:"\u5168\u5c40\u63d2\u4ef6"},l.a.createElement("a",{"aria-hidden":"true",href:"#\u5168\u5c40\u63d2\u4ef6"},l.a.createElement("span",{className:"icon icon-link"})),"\u5168\u5c40\u63d2\u4ef6"),l.a.createElement("p",null,"\u60f3\u5bf9\u6240\u6709 schema \u6ce8\u518c\u63d2\u4ef6\uff1f\u53ef\u4ee5\u4f7f\u7528 mongoose \u5355\u4f8b\u63d0\u4f9b\u7684 .plugin() \u51fd\u6570\uff0c\u8bf7\u770b\u4f8b\u5b50\uff1a"),l.a.createElement(s.a,{code:"const mongoose = require('mongoose');\nmongoose.plugin(require('./lastMod'));\n\nconst gameSchema = new Schema({ ... });\nconst playerSchema = new Schema({ ... });\n// `lastModifiedPlugin` gets attached to both schemas\nconst Game = mongoose.model('Game', gameSchema);\nconst Player = mongoose.model('Player', playerSchema);\n",lang:"js"})))}}}]);